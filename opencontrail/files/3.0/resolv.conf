{%- from "opencontrail/map.jinja" import control, compute with context %}

# Custom resolv.conf file for contrail dns
{%- if control.get('dns', {}).get('forwarders', []) %}
# vDNS is handled on contrail-api nodes
{%- set forwarders = control.dns.forwarders %}

{%- elif compute.get('dns', {}).get('forwarders', []) %}
# Default DNS is handled on the compute node
{%- set forwarders = compute.dns.forwarders %}

{%- else %}
# No forwarders/nameservers found to configure
{%- set forwarders = [] %}
{%- endif %}

{%- for host in forwarders %}
nameserver {{ host }}
{%- endfor %}
